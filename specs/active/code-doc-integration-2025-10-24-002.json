{
  "spec_id": "code-doc-integration-2025-10-24-002",
  "generated": "2025-10-24T00:00:00Z",
  "last_updated": "2025-10-24T00:00:00Z",

  "metadata": {
    "title": "Better code-doc Integration for SDD Skills (Implementation + Documentation)",
    "description": "Integrate code-doc skill into run-tests, sdd-next, and sdd-plan with both Python implementation and documentation updates. Includes shared utility, proactive generation, and comprehensive testing.",
    "status": "active",
    "complexity": "high",
    "estimated_hours": 32,
    "tags": ["documentation", "integration", "workflow-enhancement", "implementation"],
    "revision_notes": "v2: Added implementation phases, shared utilities, comprehensive testing, and content specifications based on review feedback"
  },

  "hierarchy": {
    "spec-root": {
      "type": "spec",
      "title": "Better code-doc Integration for SDD Skills",
      "status": "pending",
      "parent": null,
      "children": ["phase-1", "phase-2", "phase-3", "phase-4", "phase-5", "phase-6", "phase-7"],
      "total_tasks": 56,
      "completed_tasks": 0,
      "metadata": {
        "objectives": [
          "Implement proactive code-doc checking in Python code for all three skills",
          "Update skill documentation to explain the new workflow",
          "Create shared utility to avoid code duplication",
          "Define sdd doc stats contract for stable integration",
          "Provide comprehensive testing (unit + integration)",
          "Ensure graceful degradation when documentation unavailable"
        ]
      }
    },

    "phase-1": {
      "type": "phase",
      "title": "Foundation: Shared Utilities and Contract",
      "status": "pending",
      "parent": "spec-root",
      "children": ["phase-1-files", "phase-1-verify"],
      "dependencies": {
        "blocks": ["phase-2", "phase-3", "phase-4"],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 8,
      "completed_tasks": 0,
      "metadata": {
        "purpose": "Create shared utility for proactive doc checking and define sdd doc stats contract",
        "risk_level": "medium",
        "estimated_hours": 4,
        "priority": "critical"
      }
    },

    "phase-1-files": {
      "type": "group",
      "title": "File Modifications",
      "status": "pending",
      "parent": "phase-1",
      "children": ["task-1-1", "task-1-2"],
      "dependencies": {
        "blocks": ["phase-1-verify"],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 4,
      "completed_tasks": 0,
      "metadata": {}
    },

    "task-1-1": {
      "type": "task",
      "title": "src/sdd_common/doc_integration.py",
      "status": "pending",
      "parent": "phase-1-files",
      "children": ["task-1-1-1", "task-1-1-2"],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 2,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "src/sdd_common/doc_integration.py",
        "estimated_hours": 2,
        "changes": "Create new shared utility module for doc-checking logic",
        "content_spec": "Implement check_doc_availability(), prompt_for_generation(), and handle_user_response() functions"
      }
    },

    "task-1-1-1": {
      "type": "subtask",
      "title": "Implement check_doc_availability() function",
      "status": "pending",
      "parent": "task-1-1",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "description": "Function that calls 'sdd doc stats' and returns DocStatus enum (AVAILABLE, MISSING, STALE, ERROR)",
        "implementation_notes": "Use subprocess.run(), handle exit codes, parse output, cache results per session"
      }
    },

    "task-1-1-2": {
      "type": "subtask",
      "title": "Implement prompt_for_generation() function",
      "status": "pending",
      "parent": "task-1-1",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": ["task-1-1-1"]
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "description": "Function that displays proactive generation prompt and captures Y/n input",
        "implementation_notes": "Use input() with timeout, provide skill-specific value proposition messages"
      }
    },

    "task-1-2": {
      "type": "task",
      "title": "docs/contracts/sdd-doc-stats-contract.md",
      "status": "pending",
      "parent": "phase-1-files",
      "children": ["task-1-2-1", "task-1-2-2"],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 2,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "docs/contracts/sdd-doc-stats-contract.md",
        "estimated_hours": 1,
        "changes": "Create new contract document defining sdd doc stats behavior",
        "content_spec": "Define exit codes, output format, error conditions, and stability guarantees"
      }
    },

    "task-1-2-1": {
      "type": "subtask",
      "title": "Define sdd doc stats exit codes",
      "status": "pending",
      "parent": "task-1-2",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "description": "Document: 0=docs available, 1=docs missing, 2=error",
        "content": "Exit Code Contract: 0 (docs exist), 1 (docs missing/not generated), 2 (error/command failed)"
      }
    },

    "task-1-2-2": {
      "type": "subtask",
      "title": "Define sdd doc stats output format",
      "status": "pending",
      "parent": "task-1-2",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "description": "Document expected JSON/text output structure and required fields",
        "content": "Output format: JSON with {modules, classes, functions, complexity} or text summary"
      }
    },

    "phase-1-verify": {
      "type": "group",
      "title": "Verification",
      "status": "pending",
      "parent": "phase-1",
      "children": ["verify-1-1", "verify-1-2", "verify-1-3", "verify-1-4"],
      "dependencies": {
        "blocks": [],
        "blocked_by": ["phase-1-files"],
        "depends": []
      },
      "total_tasks": 4,
      "completed_tasks": 0,
      "metadata": {}
    },

    "verify-1-1": {
      "type": "verify",
      "title": "Unit test check_doc_availability()",
      "status": "pending",
      "parent": "phase-1-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "auto",
        "command": "pytest tests/sdd_common/test_doc_integration.py::test_check_doc_availability",
        "expected": "Tests pass for all DocStatus scenarios"
      }
    },

    "verify-1-2": {
      "type": "verify",
      "title": "Unit test prompt_for_generation()",
      "status": "pending",
      "parent": "phase-1-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "auto",
        "command": "pytest tests/sdd_common/test_doc_integration.py::test_prompt_for_generation",
        "expected": "Tests pass for Y/n/timeout scenarios"
      }
    },

    "verify-1-3": {
      "type": "verify",
      "title": "Verify contract document completeness",
      "status": "pending",
      "parent": "phase-1-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "manual",
        "expected": "Contract defines all exit codes, output formats, and error conditions"
      }
    },

    "verify-1-4": {
      "type": "verify",
      "title": "Verify shared utility can be imported",
      "status": "pending",
      "parent": "phase-1-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "auto",
        "command": "python -c 'from sdd_common.doc_integration import check_doc_availability'",
        "expected": "Import succeeds without errors"
      }
    },

    "phase-2": {
      "type": "phase",
      "title": "Implementation: run-tests Skill",
      "status": "pending",
      "parent": "spec-root",
      "children": ["phase-2-files", "phase-2-verify"],
      "dependencies": {
        "blocks": ["phase-5", "phase-6"],
        "blocked_by": ["phase-1"],
        "depends": []
      },
      "total_tasks": 9,
      "completed_tasks": 0,
      "metadata": {
        "purpose": "Implement proactive doc checking in run-tests Python code",
        "risk_level": "medium",
        "estimated_hours": 4,
        "priority": "high"
      }
    },

    "phase-2-files": {
      "type": "group",
      "title": "File Modifications",
      "status": "pending",
      "parent": "phase-2",
      "children": ["task-2-1", "task-2-2"],
      "dependencies": {
        "blocks": ["phase-2-verify"],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 5,
      "completed_tasks": 0,
      "metadata": {}
    },

    "task-2-1": {
      "type": "task",
      "title": "skills/run-tests/run_tests.py",
      "status": "pending",
      "parent": "phase-2-files",
      "children": ["task-2-1-1", "task-2-1-2", "task-2-1-3"],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 3,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "skills/run-tests/run_tests.py",
        "estimated_hours": 2,
        "changes": "Add proactive doc checking to test failure analysis workflow"
      }
    },

    "task-2-1-1": {
      "type": "subtask",
      "title": "Import shared doc_integration utility",
      "status": "pending",
      "parent": "task-2-1",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "description": "Add import statement for check_doc_availability and prompt_for_generation",
        "section_identifier": "Near top of file, after other imports"
      }
    },

    "task-2-1-2": {
      "type": "subtask",
      "title": "Add proactive check in test failure analysis",
      "status": "pending",
      "parent": "task-2-1",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": ["task-2-1-1"]
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "description": "Call check_doc_availability() before external tool consultation",
        "section_identifier": "In analyze_failures() function, before calling external AI tools"
      }
    },

    "task-2-1-3": {
      "type": "subtask",
      "title": "Handle user response and graceful degradation",
      "status": "pending",
      "parent": "task-2-1",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": ["task-2-1-2"]
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "description": "If user accepts, call Skill(code-doc). If declines, log message and continue",
        "section_identifier": "After prompt_for_generation() call"
      }
    },

    "task-2-2": {
      "type": "task",
      "title": "tests/run_tests/test_doc_integration.py",
      "status": "pending",
      "parent": "phase-2-files",
      "children": ["task-2-2-1", "task-2-2-2"],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": ["task-2-1"]
      },
      "total_tasks": 2,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "tests/run_tests/test_doc_integration.py",
        "estimated_hours": 1.5,
        "changes": "Create new test file for doc integration in run-tests"
      }
    },

    "task-2-2-1": {
      "type": "subtask",
      "title": "Test proactive check is called",
      "status": "pending",
      "parent": "task-2-2",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "description": "Unit test that analyze_failures() calls check_doc_availability()",
        "test_scenarios": "Mock check_doc_availability(), verify it's called"
      }
    },

    "task-2-2-2": {
      "type": "subtask",
      "title": "Test graceful degradation",
      "status": "pending",
      "parent": "task-2-2",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "description": "Test that workflow continues if user declines or docs unavailable",
        "test_scenarios": "Simulate user decline, verify external tools still called"
      }
    },

    "phase-2-verify": {
      "type": "group",
      "title": "Verification",
      "status": "pending",
      "parent": "phase-2",
      "children": ["verify-2-1", "verify-2-2", "verify-2-3", "verify-2-4"],
      "dependencies": {
        "blocks": [],
        "blocked_by": ["phase-2-files"],
        "depends": []
      },
      "total_tasks": 4,
      "completed_tasks": 0,
      "metadata": {}
    },

    "verify-2-1": {
      "type": "verify",
      "title": "Run run-tests unit tests",
      "status": "pending",
      "parent": "phase-2-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "auto",
        "command": "pytest tests/run_tests/test_doc_integration.py -v",
        "expected": "All tests pass"
      }
    },

    "verify-2-2": {
      "type": "verify",
      "title": "Integration test: docs available path",
      "status": "pending",
      "parent": "phase-2-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "auto",
        "command": "pytest tests/integration/test_run_tests_doc_integration.py::test_docs_available",
        "expected": "Workflow uses docs when available"
      }
    },

    "verify-2-3": {
      "type": "verify",
      "title": "Integration test: docs missing, user accepts",
      "status": "pending",
      "parent": "phase-2-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "auto",
        "command": "pytest tests/integration/test_run_tests_doc_integration.py::test_docs_missing_accept",
        "expected": "code-doc skill is called, then workflow continues"
      }
    },

    "verify-2-4": {
      "type": "verify",
      "title": "Integration test: docs missing, user declines",
      "status": "pending",
      "parent": "phase-2-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "auto",
        "command": "pytest tests/integration/test_run_tests_doc_integration.py::test_docs_missing_decline",
        "expected": "Graceful degradation: workflow continues without docs"
      }
    },

    "phase-3": {
      "type": "phase",
      "title": "Implementation: sdd-next Skill",
      "status": "pending",
      "parent": "spec-root",
      "children": ["phase-3-files", "phase-3-verify"],
      "dependencies": {
        "blocks": ["phase-5", "phase-6"],
        "blocked_by": ["phase-1"],
        "depends": []
      },
      "total_tasks": 9,
      "completed_tasks": 0,
      "metadata": {
        "purpose": "Implement proactive doc checking in sdd-next Python code",
        "risk_level": "medium",
        "estimated_hours": 4,
        "priority": "high"
      }
    },

    "phase-3-files": {
      "type": "group",
      "title": "File Modifications",
      "status": "pending",
      "parent": "phase-3",
      "children": ["task-3-1", "task-3-2"],
      "dependencies": {
        "blocks": ["phase-3-verify"],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 5,
      "completed_tasks": 0,
      "metadata": {}
    },

    "task-3-1": {
      "type": "task",
      "title": "skills/sdd-next/sdd_next.py",
      "status": "pending",
      "parent": "phase-3-files",
      "children": ["task-3-1-1", "task-3-1-2", "task-3-1-3"],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 3,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "skills/sdd-next/sdd_next.py",
        "estimated_hours": 2,
        "changes": "Add proactive doc checking to task preparation workflow"
      }
    },

    "task-3-1-1": {
      "type": "subtask",
      "title": "Import shared doc_integration utility",
      "status": "pending",
      "parent": "task-3-1",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "description": "Add import statement for check_doc_availability and prompt_for_generation",
        "section_identifier": "Near top of file, after other imports"
      }
    },

    "task-3-1-2": {
      "type": "subtask",
      "title": "Add proactive check in task preparation",
      "status": "pending",
      "parent": "task-3-1",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": ["task-3-1-1"]
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "description": "Call check_doc_availability() before gathering task context",
        "section_identifier": "In prepare_task() function, at beginning of context gathering"
      }
    },

    "task-3-1-3": {
      "type": "subtask",
      "title": "Handle user response and graceful degradation",
      "status": "pending",
      "parent": "task-3-1",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": ["task-3-1-2"]
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "description": "If user accepts, call Skill(code-doc). If declines, use manual exploration",
        "section_identifier": "After prompt_for_generation() call"
      }
    },

    "task-3-2": {
      "type": "task",
      "title": "tests/sdd_next/test_doc_integration.py",
      "status": "pending",
      "parent": "phase-3-files",
      "children": ["task-3-2-1", "task-3-2-2"],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": ["task-3-1"]
      },
      "total_tasks": 2,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "tests/sdd_next/test_doc_integration.py",
        "estimated_hours": 1.5,
        "changes": "Create new test file for doc integration in sdd-next"
      }
    },

    "task-3-2-1": {
      "type": "subtask",
      "title": "Test proactive check is called",
      "status": "pending",
      "parent": "task-3-2",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "description": "Unit test that prepare_task() calls check_doc_availability()",
        "test_scenarios": "Mock check_doc_availability(), verify it's called"
      }
    },

    "task-3-2-2": {
      "type": "subtask",
      "title": "Test graceful degradation",
      "status": "pending",
      "parent": "task-3-2",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "description": "Test that workflow continues with manual exploration if user declines",
        "test_scenarios": "Simulate user decline, verify manual exploration path"
      }
    },

    "phase-3-verify": {
      "type": "group",
      "title": "Verification",
      "status": "pending",
      "parent": "phase-3",
      "children": ["verify-3-1", "verify-3-2", "verify-3-3", "verify-3-4"],
      "dependencies": {
        "blocks": [],
        "blocked_by": ["phase-3-files"],
        "depends": []
      },
      "total_tasks": 4,
      "completed_tasks": 0,
      "metadata": {}
    },

    "verify-3-1": {
      "type": "verify",
      "title": "Run sdd-next unit tests",
      "status": "pending",
      "parent": "phase-3-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "auto",
        "command": "pytest tests/sdd_next/test_doc_integration.py -v",
        "expected": "All tests pass"
      }
    },

    "verify-3-2": {
      "type": "verify",
      "title": "Integration test: docs available path",
      "status": "pending",
      "parent": "phase-3-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "auto",
        "command": "pytest tests/integration/test_sdd_next_doc_integration.py::test_docs_available",
        "expected": "Workflow uses sdd doc context when available"
      }
    },

    "verify-3-3": {
      "type": "verify",
      "title": "Integration test: docs missing, user accepts",
      "status": "pending",
      "parent": "phase-3-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "auto",
        "command": "pytest tests/integration/test_sdd_next_doc_integration.py::test_docs_missing_accept",
        "expected": "code-doc skill is called, then context gathering proceeds"
      }
    },

    "verify-3-4": {
      "type": "verify",
      "title": "Integration test: docs missing, user declines",
      "status": "pending",
      "parent": "phase-3-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "auto",
        "command": "pytest tests/integration/test_sdd_next_doc_integration.py::test_docs_missing_decline",
        "expected": "Graceful degradation: manual exploration path used"
      }
    },

    "phase-4": {
      "type": "phase",
      "title": "Implementation: sdd-plan Skill",
      "status": "pending",
      "parent": "spec-root",
      "children": ["phase-4-files", "phase-4-verify"],
      "dependencies": {
        "blocks": ["phase-5", "phase-6"],
        "blocked_by": ["phase-1"],
        "depends": []
      },
      "total_tasks": 9,
      "completed_tasks": 0,
      "metadata": {
        "purpose": "Implement proactive doc checking in sdd-plan Python code",
        "risk_level": "medium",
        "estimated_hours": 4,
        "priority": "medium"
      }
    },

    "phase-4-files": {
      "type": "group",
      "title": "File Modifications",
      "status": "pending",
      "parent": "phase-4",
      "children": ["task-4-1", "task-4-2"],
      "dependencies": {
        "blocks": ["phase-4-verify"],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 5,
      "completed_tasks": 0,
      "metadata": {}
    },

    "task-4-1": {
      "type": "task",
      "title": "skills/sdd-plan/sdd_plan.py",
      "status": "pending",
      "parent": "phase-4-files",
      "children": ["task-4-1-1", "task-4-1-2", "task-4-1-3"],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 3,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "skills/sdd-plan/sdd_plan.py",
        "estimated_hours": 2,
        "changes": "Add proactive doc checking to planning workflow"
      }
    },

    "task-4-1-1": {
      "type": "subtask",
      "title": "Import shared doc_integration utility",
      "status": "pending",
      "parent": "task-4-1",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "description": "Add import statement for check_doc_availability and prompt_for_generation",
        "section_identifier": "Near top of file, after other imports"
      }
    },

    "task-4-1-2": {
      "type": "subtask",
      "title": "Add proactive check in codebase analysis",
      "status": "pending",
      "parent": "task-4-1",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": ["task-4-1-1"]
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "description": "Call check_doc_availability() before analyzing codebase",
        "section_identifier": "In analyze_codebase() function, before manual exploration"
      }
    },

    "task-4-1-3": {
      "type": "subtask",
      "title": "Handle user response and graceful degradation",
      "status": "pending",
      "parent": "task-4-1",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": ["task-4-1-2"]
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "description": "If user accepts, call Skill(code-doc). If declines, use manual analysis",
        "section_identifier": "After prompt_for_generation() call"
      }
    },

    "task-4-2": {
      "type": "task",
      "title": "tests/sdd_plan/test_doc_integration.py",
      "status": "pending",
      "parent": "phase-4-files",
      "children": ["task-4-2-1", "task-4-2-2"],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": ["task-4-1"]
      },
      "total_tasks": 2,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "tests/sdd_plan/test_doc_integration.py",
        "estimated_hours": 1.5,
        "changes": "Create new test file for doc integration in sdd-plan"
      }
    },

    "task-4-2-1": {
      "type": "subtask",
      "title": "Test proactive check is called",
      "status": "pending",
      "parent": "task-4-2",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "description": "Unit test that analyze_codebase() calls check_doc_availability()",
        "test_scenarios": "Mock check_doc_availability(), verify it's called"
      }
    },

    "task-4-2-2": {
      "type": "subtask",
      "title": "Test graceful degradation",
      "status": "pending",
      "parent": "task-4-2",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "description": "Test that workflow continues with manual analysis if user declines",
        "test_scenarios": "Simulate user decline, verify manual analysis path"
      }
    },

    "phase-4-verify": {
      "type": "group",
      "title": "Verification",
      "status": "pending",
      "parent": "phase-4",
      "children": ["verify-4-1", "verify-4-2", "verify-4-3", "verify-4-4"],
      "dependencies": {
        "blocks": [],
        "blocked_by": ["phase-4-files"],
        "depends": []
      },
      "total_tasks": 4,
      "completed_tasks": 0,
      "metadata": {}
    },

    "verify-4-1": {
      "type": "verify",
      "title": "Run sdd-plan unit tests",
      "status": "pending",
      "parent": "phase-4-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "auto",
        "command": "pytest tests/sdd_plan/test_doc_integration.py -v",
        "expected": "All tests pass"
      }
    },

    "verify-4-2": {
      "type": "verify",
      "title": "Integration test: docs available path",
      "status": "pending",
      "parent": "phase-4-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "auto",
        "command": "pytest tests/integration/test_sdd_plan_doc_integration.py::test_docs_available",
        "expected": "Workflow uses doc queries when available"
      }
    },

    "verify-4-3": {
      "type": "verify",
      "title": "Integration test: docs missing, user accepts",
      "status": "pending",
      "parent": "phase-4-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "auto",
        "command": "pytest tests/integration/test_sdd_plan_doc_integration.py::test_docs_missing_accept",
        "expected": "code-doc skill is called, then planning proceeds"
      }
    },

    "verify-4-4": {
      "type": "verify",
      "title": "Integration test: docs missing, user declines",
      "status": "pending",
      "parent": "phase-4-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "auto",
        "command": "pytest tests/integration/test_sdd_plan_doc_integration.py::test_docs_missing_decline",
        "expected": "Graceful degradation: manual analysis path used"
      }
    },

    "phase-5": {
      "type": "phase",
      "title": "Documentation: Update SKILL.md Files",
      "status": "pending",
      "parent": "spec-root",
      "children": ["phase-5-files", "phase-5-verify"],
      "dependencies": {
        "blocks": ["phase-6"],
        "blocked_by": ["phase-2", "phase-3", "phase-4"],
        "depends": []
      },
      "total_tasks": 10,
      "completed_tasks": 0,
      "metadata": {
        "purpose": "Update skill documentation to reflect new proactive workflow",
        "risk_level": "low",
        "estimated_hours": 6,
        "priority": "medium"
      }
    },

    "phase-5-files": {
      "type": "group",
      "title": "File Modifications",
      "status": "pending",
      "parent": "phase-5",
      "children": ["task-5-1", "task-5-2", "task-5-3"],
      "dependencies": {
        "blocks": ["phase-5-verify"],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 6,
      "completed_tasks": 0,
      "metadata": {}
    },

    "task-5-1": {
      "type": "task",
      "title": "skills/run-tests/SKILL.md",
      "status": "pending",
      "parent": "phase-5-files",
      "children": ["task-5-1-1", "task-5-1-2"],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 2,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "skills/run-tests/SKILL.md",
        "estimated_hours": 2,
        "changes": "Add documentation about proactive doc checking"
      }
    },

    "task-5-1-1": {
      "type": "subtask",
      "title": "Add section explaining proactive doc checking",
      "status": "pending",
      "parent": "task-5-1",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "description": "Add new section after Phase 2 explaining automatic doc availability check",
        "section_identifier": "After '## Phase 2: Analyze Failures' heading",
        "content_spec": "Explain that skill automatically checks for docs, prompts user if missing, shows value proposition, handles graceful degradation"
      }
    },

    "task-5-1-2": {
      "type": "subtask",
      "title": "Add command reference table",
      "status": "pending",
      "parent": "task-5-1",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": ["task-5-1-1"]
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "description": "Add table with most useful doc-query commands for debugging",
        "section_identifier": "At end of new proactive checking section",
        "content_spec": "Table with: sdd doc search, sdd doc dependencies --reverse, sdd doc describe-module, sdd doc find-function, sdd doc complexity, sdd doc context"
      }
    },

    "task-5-2": {
      "type": "task",
      "title": "skills/sdd-next/SKILL.md",
      "status": "pending",
      "parent": "phase-5-files",
      "children": ["task-5-2-1", "task-5-2-2"],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 2,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "skills/sdd-next/SKILL.md",
        "estimated_hours": 2,
        "changes": "Add documentation about proactive doc checking"
      }
    },

    "task-5-2-1": {
      "type": "subtask",
      "title": "Add section explaining proactive doc checking",
      "status": "pending",
      "parent": "task-5-2",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "description": "Add new section in task preparation phase explaining automatic check",
        "section_identifier": "In '### Phase 1: Task Identification and Preparation' section",
        "content_spec": "Explain automatic check, value prop (10x faster context), prompt behavior, graceful degradation to manual exploration"
      }
    },

    "task-5-2-2": {
      "type": "subtask",
      "title": "Add command reference table",
      "status": "pending",
      "parent": "task-5-2",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": ["task-5-2-1"]
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "description": "Add table with most useful doc-query commands for task prep",
        "section_identifier": "At end of new proactive checking section",
        "content_spec": "Table with: sdd doc stats, sdd doc context, sdd doc search, sdd doc dependencies, sdd doc find-class, sdd doc complexity"
      }
    },

    "task-5-3": {
      "type": "task",
      "title": "skills/sdd-plan/SKILL.md",
      "status": "pending",
      "parent": "phase-5-files",
      "children": ["task-5-3-1", "task-5-3-2"],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 2,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "skills/sdd-plan/SKILL.md",
        "estimated_hours": 2,
        "changes": "Add documentation about proactive doc checking"
      }
    },

    "task-5-3-1": {
      "type": "subtask",
      "title": "Add section explaining proactive doc checking",
      "status": "pending",
      "parent": "task-5-3",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "description": "Add new section in codebase analysis phase explaining automatic check",
        "section_identifier": "In '#### 1.2 Analyze the Codebase' section",
        "content_spec": "Explain automatic check, value prop (comprehensive understanding), prompt behavior, graceful degradation to manual analysis"
      }
    },

    "task-5-3-2": {
      "type": "subtask",
      "title": "Add command reference table",
      "status": "pending",
      "parent": "task-5-3",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": ["task-5-3-1"]
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "description": "Add table with most useful doc-query commands for planning",
        "section_identifier": "At end of new proactive checking section",
        "content_spec": "Table with: sdd doc stats, sdd doc search, sdd doc context, sdd doc dependencies --reverse, sdd doc complexity, sdd doc list-modules"
      }
    },

    "phase-5-verify": {
      "type": "group",
      "title": "Verification",
      "status": "pending",
      "parent": "phase-5",
      "children": ["verify-5-1", "verify-5-2", "verify-5-3", "verify-5-4"],
      "dependencies": {
        "blocks": [],
        "blocked_by": ["phase-5-files"],
        "depends": []
      },
      "total_tasks": 4,
      "completed_tasks": 0,
      "metadata": {}
    },

    "verify-5-1": {
      "type": "verify",
      "title": "Verify markdown formatting is valid",
      "status": "pending",
      "parent": "phase-5-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "auto",
        "command": "markdownlint skills/run-tests/SKILL.md skills/sdd-next/SKILL.md skills/sdd-plan/SKILL.md",
        "expected": "No markdown linting errors"
      }
    },

    "verify-5-2": {
      "type": "verify",
      "title": "Verify command examples are accurate",
      "status": "pending",
      "parent": "phase-5-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "manual",
        "expected": "All sdd doc commands use correct syntax and realistic examples"
      }
    },

    "verify-5-3": {
      "type": "verify",
      "title": "Verify sections added at correct locations",
      "status": "pending",
      "parent": "phase-5-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "manual",
        "expected": "All new sections appear after specified section identifiers with proper hierarchy"
      }
    },

    "verify-5-4": {
      "type": "verify",
      "title": "Verify graceful degradation is documented",
      "status": "pending",
      "parent": "phase-5-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "manual",
        "expected": "Documentation clearly explains what happens when docs unavailable or user declines"
      }
    },

    "phase-6": {
      "type": "phase",
      "title": "End-to-End Testing",
      "status": "pending",
      "parent": "spec-root",
      "children": ["phase-6-files", "phase-6-verify"],
      "dependencies": {
        "blocks": ["phase-7"],
        "blocked_by": ["phase-2", "phase-3", "phase-4", "phase-5"],
        "depends": []
      },
      "total_tasks": 7,
      "completed_tasks": 0,
      "metadata": {
        "purpose": "Test complete workflows across all three skills",
        "risk_level": "medium",
        "estimated_hours": 4,
        "priority": "high"
      }
    },

    "phase-6-files": {
      "type": "group",
      "title": "File Modifications",
      "status": "pending",
      "parent": "phase-6",
      "children": ["task-6-1"],
      "dependencies": {
        "blocks": ["phase-6-verify"],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 3,
      "completed_tasks": 0,
      "metadata": {}
    },

    "task-6-1": {
      "type": "task",
      "title": "tests/e2e/test_doc_integration_workflows.py",
      "status": "pending",
      "parent": "phase-6-files",
      "children": ["task-6-1-1", "task-6-1-2", "task-6-1-3"],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 3,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "tests/e2e/test_doc_integration_workflows.py",
        "estimated_hours": 3,
        "changes": "Create end-to-end workflow tests"
      }
    },

    "task-6-1-1": {
      "type": "subtask",
      "title": "Test run-tests complete workflow",
      "status": "pending",
      "parent": "task-6-1",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "description": "E2E test: run failing tests, verify doc check prompt, accept, verify docs used in debugging",
        "test_scenarios": "Full workflow from test failure through doc-enhanced debugging"
      }
    },

    "task-6-1-2": {
      "type": "subtask",
      "title": "Test sdd-next complete workflow",
      "status": "pending",
      "parent": "task-6-1",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "description": "E2E test: prepare task, verify doc check prompt, accept, verify docs used in context gathering",
        "test_scenarios": "Full workflow from task selection through doc-enhanced preparation"
      }
    },

    "task-6-1-3": {
      "type": "subtask",
      "title": "Test sdd-plan complete workflow",
      "status": "pending",
      "parent": "task-6-1",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "description": "E2E test: start planning, verify doc check prompt, accept, verify docs used in codebase analysis",
        "test_scenarios": "Full workflow from plan start through doc-enhanced analysis"
      }
    },

    "phase-6-verify": {
      "type": "group",
      "title": "Verification",
      "status": "pending",
      "parent": "phase-6",
      "children": ["verify-6-1", "verify-6-2", "verify-6-3", "verify-6-4"],
      "dependencies": {
        "blocks": [],
        "blocked_by": ["phase-6-files"],
        "depends": []
      },
      "total_tasks": 4,
      "completed_tasks": 0,
      "metadata": {}
    },

    "verify-6-1": {
      "type": "verify",
      "title": "Run all E2E tests",
      "status": "pending",
      "parent": "phase-6-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "auto",
        "command": "pytest tests/e2e/test_doc_integration_workflows.py -v",
        "expected": "All E2E tests pass"
      }
    },

    "verify-6-2": {
      "type": "verify",
      "title": "Manual smoke test: run-tests with missing docs",
      "status": "pending",
      "parent": "phase-6-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "manual",
        "expected": "Skill prompts for doc generation, accepts input, calls code-doc skill"
      }
    },

    "verify-6-3": {
      "type": "verify",
      "title": "Manual smoke test: sdd-next with available docs",
      "status": "pending",
      "parent": "phase-6-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "manual",
        "expected": "Skill uses docs automatically, shows value message, context gathering succeeds"
      }
    },

    "verify-6-4": {
      "type": "verify",
      "title": "Manual smoke test: sdd-plan with user decline",
      "status": "pending",
      "parent": "phase-6-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "manual",
        "expected": "Skill gracefully degrades to manual analysis, no errors, planning succeeds"
      }
    },

    "phase-7": {
      "type": "phase",
      "title": "Final Validation and Documentation",
      "status": "pending",
      "parent": "spec-root",
      "children": ["phase-7-verify"],
      "dependencies": {
        "blocks": [],
        "blocked_by": ["phase-6"],
        "depends": []
      },
      "total_tasks": 4,
      "completed_tasks": 0,
      "metadata": {
        "purpose": "Final checks and create integration guide",
        "risk_level": "low",
        "estimated_hours": 2,
        "priority": "medium"
      }
    },

    "phase-7-verify": {
      "type": "group",
      "title": "Verification",
      "status": "pending",
      "parent": "phase-7",
      "children": ["verify-7-1", "verify-7-2", "verify-7-3", "verify-7-4"],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 4,
      "completed_tasks": 0,
      "metadata": {}
    },

    "verify-7-1": {
      "type": "verify",
      "title": "Run full test suite",
      "status": "pending",
      "parent": "phase-7-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "auto",
        "command": "pytest tests/ -v --cov=src/sdd_common --cov=skills/run-tests --cov=skills/sdd-next --cov=skills/sdd-plan",
        "expected": "All tests pass, coverage > 80%"
      }
    },

    "verify-7-2": {
      "type": "verify",
      "title": "Verify no regressions in existing workflows",
      "status": "pending",
      "parent": "phase-7-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "manual",
        "expected": "All three skills work normally when docs are already available (no prompts shown)"
      }
    },

    "verify-7-3": {
      "type": "verify",
      "title": "Verify sdd doc stats contract compliance",
      "status": "pending",
      "parent": "phase-7-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "manual",
        "expected": "Integration respects all exit codes and output formats defined in contract"
      }
    },

    "verify-7-4": {
      "type": "verify",
      "title": "Create integration guide document",
      "status": "pending",
      "parent": "phase-7-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "manual",
        "expected": "docs/code-doc-integration-guide.md created with usage examples and troubleshooting"
      }
    }
  }
}
