{
  "spec_id": "sdd-validate-docs-2025-10-24-001",
  "generated": "2025-10-24T21:30:00Z",
  "last_updated": "2025-10-26T12:00:00Z",
  "metadata": {
    "title": "sdd-validate Documentation Improvements",
    "description": "Improve SKILL.md to clarify exit codes, iterative workflow, auto-fix limitations, and add troubleshooting guidance",
    "status": "pending",
    "priority": "medium",
    "estimated_hours": 4,
    "complexity": "low"
  },

  "hierarchy": {
    "spec-root": {
      "type": "spec",
      "title": "sdd-validate Documentation Improvements",
      "status": "pending",
      "parent": null,
      "children": ["phase-0", "phase-1", "phase-2"],
      "total_tasks": 16,
      "completed_tasks": 0,
      "metadata": {
        "description": "Fix auto-fix path resolution bug and address confusion around exit codes, iterative fixing, and auto-fix limitations based on real user experience"
      }
    },

    "phase-0": {
      "type": "phase",
      "title": "Bug Fixes",
      "status": "pending",
      "parent": "spec-root",
      "children": ["phase-0-files", "phase-0-verify"],
      "dependencies": {
        "blocks": ["phase-1"],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 5,
      "completed_tasks": 0,
      "metadata": {
        "purpose": "Fix auto-fix path resolution bug that prevents fixes from being saved",
        "risk_level": "low",
        "estimated_hours": 2
      }
    },

    "phase-0-files": {
      "type": "group",
      "title": "File Modifications",
      "status": "pending",
      "parent": "phase-0",
      "children": ["task-0-1"],
      "dependencies": {
        "blocks": ["phase-0-verify"],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 3,
      "completed_tasks": 0,
      "metadata": {}
    },

    "task-0-1": {
      "type": "task",
      "title": "src/claude_skills/claude_skills/sdd_validate/fix.py",
      "status": "pending",
      "parent": "phase-0-files",
      "children": ["task-0-1-1", "task-0-1-2", "task-0-1-3"],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 3,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "src/claude_skills/claude_skills/sdd_validate/fix.py",
        "estimated_hours": 1,
        "changes": "Fix path resolution in apply_fix_actions function for both backup_json_spec (line 125) and save_json_spec (line 157) calls to use find_specs_directory utility",
        "reasoning": "Current implementation passes specs/active as specs_dir, but find_spec_file expects specs/ parent directory. This causes backup_json_spec to fail (resulting in .backup files in specs/active/ instead of specs/.backups/) and save_json_spec to fail silently.",
        "integration_points": [
          "Uses find_specs_directory from common.paths",
          "Maintains backward compatibility with fallback",
          "No API changes, purely internal fix",
          "Fixes both backup creation and save operations"
        ]
      }
    },

    "task-0-1-1": {
      "type": "subtask",
      "title": "Import find_specs_directory utility",
      "status": "pending",
      "parent": "task-0-1",
      "children": [],
      "dependencies": {
        "blocks": ["task-0-1-2"],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "details": "Add find_specs_directory to imports from claude_skills.common at top of file",
        "location": "Line 17 (import section)"
      }
    },

    "task-0-1-2": {
      "type": "subtask",
      "title": "Update apply_fix_actions path resolution",
      "status": "pending",
      "parent": "task-0-1",
      "children": [],
      "dependencies": {
        "blocks": ["task-0-1-3"],
        "blocked_by": ["task-0-1-1"],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "details": "Replace both line 125 backup_json_spec call and line 157 save_json_spec call to use find_specs_directory(str(spec_path)) instead of Path(spec_path).parent",
        "location": "Lines 125 and 157 in apply_fix_actions function"
      }
    },

    "task-0-1-3": {
      "type": "subtask",
      "title": "Add fallback for non-standard layouts",
      "status": "pending",
      "parent": "task-0-1",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": ["task-0-1-2"],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "details": "Add conditional logic: if find_specs_directory returns None, fall back to current behavior (Path(spec_path).parent) to maintain backward compatibility",
        "location": "Line 157 in apply_fix_actions function"
      }
    },

    "phase-0-verify": {
      "type": "group",
      "title": "Verification",
      "status": "pending",
      "parent": "phase-0",
      "children": ["verify-0-1", "verify-0-2"],
      "dependencies": {
        "blocks": [],
        "blocked_by": ["phase-0-files"],
        "depends": []
      },
      "total_tasks": 2,
      "completed_tasks": 0,
      "metadata": {}
    },

    "verify-0-1": {
      "type": "verify",
      "title": "Test fix with failing auto-completion spec",
      "status": "pending",
      "parent": "phase-0-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "auto",
        "command": "sdd validate specs/active/auto-completion-detection-2025-10-26-001.json && sdd fix specs/active/auto-completion-detection-2025-10-26-001.json && sdd validate specs/active/auto-completion-detection-2025-10-26-001.json",
        "expected": "Fix command successfully applies fixes and reduces error count on re-validation"
      }
    },

    "verify-0-2": {
      "type": "verify",
      "title": "Test with different directory structures",
      "status": "pending",
      "parent": "phase-0-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "manual",
        "command": "# Test fix command with: (1) standard layout specs/active/, (2) direct specs/ path, (3) nested project structure",
        "expected": "Fix command works correctly regardless of where spec file is located in directory hierarchy"
      }
    },

    "phase-1": {
      "type": "phase",
      "title": "Documentation Updates",
      "status": "pending",
      "parent": "spec-root",
      "children": ["phase-1-files", "phase-1-verify"],
      "dependencies": {
        "blocks": ["phase-2", "task-2-1"],
        "blocked_by": ["phase-0"],
        "depends": []
      },
      "total_tasks": 7,
      "completed_tasks": 0,
      "metadata": {
        "purpose": "Update SKILL.md with clarifications, workflow improvements, and troubleshooting guidance",
        "risk_level": "low",
        "estimated_hours": 2
      }
    },

    "phase-1-files": {
      "type": "group",
      "title": "File Modifications",
      "status": "pending",
      "parent": "phase-1",
      "children": ["task-1-1"],
      "dependencies": {
        "blocks": ["phase-1-verify"],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 5,
      "completed_tasks": 0,
      "metadata": {}
    },

    "task-1-1": {
      "type": "task",
      "title": "skills/sdd-validate/SKILL.md",
      "status": "pending",
      "parent": "phase-1-files",
      "children": ["task-1-1-1", "task-1-1-2", "task-1-1-3", "task-1-1-4", "task-1-1-5"],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 5,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "skills/sdd-validate/SKILL.md",
        "estimated_hours": 2,
        "changes": "Add clarifications, workflow guidance, troubleshooting, and decision trees"
      }
    },

    "task-1-1-1": {
      "type": "subtask",
      "title": "Enhance exit code explanation section",
      "status": "pending",
      "parent": "task-1-1",
      "children": [],
      "dependencies": {
        "blocks": ["task-1-1-2", "task-1-1-3"],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "details": "Update lines 82-86 and 102-105 to emphasize exit code 2 is 'validation found errors' not 'command failed'. Add note for AI assistants that this is expected behavior.",
        "location": "Lines 82-86, 102-105"
      }
    },

    "task-1-1-2": {
      "type": "subtask",
      "title": "Add iterative fixing workflow section",
      "status": "pending",
      "parent": "task-1-1",
      "children": [],
      "dependencies": {
        "blocks": ["task-1-1-4"],
        "blocked_by": ["task-1-1-1"],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "details": "Add new section after line 220 explaining: (1) may need multiple fix passes, (2) some fixes enable detection of new issues, (3) when to stop iterating, (4) fix success doesn't mean all issues fixed",
        "location": "After line 220 in 'Complete Validation Workflow' section"
      }
    },

    "task-1-1-3": {
      "type": "subtask",
      "title": "Update auto-fix documentation with limitations",
      "status": "pending",
      "parent": "task-1-1",
      "children": [],
      "dependencies": {
        "blocks": ["task-1-1-4"],
        "blocked_by": ["task-1-1-1"],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "details": "Update lines 120-133 to add note that 'auto-fixable' doesn't guarantee fix will be applied - some issues require context. Explain exit 0 from fix means 'applied what it could' not 'fixed everything'",
        "location": "Lines 120-133 in 'Auto-fixable issues' section"
      }
    },

    "task-1-1-4": {
      "type": "subtask",
      "title": "Add troubleshooting common issues section",
      "status": "pending",
      "parent": "task-1-1",
      "children": [],
      "dependencies": {
        "blocks": ["task-1-1-5"],
        "blocked_by": ["task-1-1-2", "task-1-1-3"],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "details": "Add new section after validation workflow covering: (1) 'Auto-fix succeeded but validation still shows errors', (2) 'How many times should I run fix?', (3) 'When to give up on auto-fix and fix manually?', (4) Real scenario from our experience",
        "location": "New section after line 220"
      }
    },

    "task-1-1-5": {
      "type": "subtask",
      "title": "Add decision tree for stopping auto-fix",
      "status": "pending",
      "parent": "task-1-1",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": ["task-1-1-4"],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "details": "Add flowchart/decision tree: Run validate → Errors? → Run fix → Re-validate → Same errors? → Check if auto-fixable list changed → No change = needs manual fix → Yes change = run fix again",
        "location": "Within troubleshooting section"
      }
    },

    "phase-1-verify": {
      "type": "group",
      "title": "Verification",
      "status": "pending",
      "parent": "phase-1",
      "children": ["verify-1-1", "verify-1-2"],
      "dependencies": {
        "blocks": [],
        "blocked_by": ["phase-1-files"],
        "depends": []
      },
      "total_tasks": 2,
      "completed_tasks": 0,
      "metadata": {}
    },

    "verify-1-1": {
      "type": "verify",
      "title": "Documentation structure is valid markdown",
      "status": "pending",
      "parent": "phase-1-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "auto",
        "command": "markdownlint skills/sdd-validate/SKILL.md || echo 'No markdown linter installed - manual review required'",
        "expected": "Markdown is well-formed with proper heading hierarchy"
      }
    },

    "verify-1-2": {
      "type": "verify",
      "title": "All sections are clear and actionable",
      "status": "pending",
      "parent": "phase-1-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "manual",
        "command": "# Manual review required",
        "expected": "Read through documentation ensuring: (1) exit code explanation is unambiguous, (2) workflow steps are sequential and clear, (3) troubleshooting covers our scenario"
      }
    },

    "phase-2": {
      "type": "phase",
      "title": "Examples and Verification",
      "status": "pending",
      "parent": "spec-root",
      "children": ["phase-2-files", "phase-2-verify"],
      "dependencies": {
        "blocks": [],
        "blocked_by": ["phase-1"],
        "depends": []
      },
      "total_tasks": 4,
      "completed_tasks": 0,
      "metadata": {
        "purpose": "Add practical examples and validate documentation clarity",
        "risk_level": "low",
        "estimated_hours": 2
      }
    },

    "phase-2-files": {
      "type": "group",
      "title": "File Modifications",
      "status": "pending",
      "parent": "phase-2",
      "children": ["task-2-1"],
      "dependencies": {
        "blocks": ["phase-2-verify"],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 3,
      "completed_tasks": 0,
      "metadata": {}
    },

    "task-2-1": {
      "type": "task",
      "title": "skills/sdd-validate/SKILL.md",
      "status": "pending",
      "parent": "phase-2-files",
      "children": ["task-2-1-1", "task-2-1-2", "task-2-1-3"],
      "dependencies": {
        "blocks": [],
        "blocked_by": ["phase-1"],
        "depends": []
      },
      "total_tasks": 3,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "skills/sdd-validate/SKILL.md",
        "estimated_hours": 1.5,
        "changes": "Add real-world examples, code snippets, and AI assistant guidelines"
      }
    },

    "task-2-1-1": {
      "type": "subtask",
      "title": "Add real-world workflow examples",
      "status": "pending",
      "parent": "task-2-1",
      "children": [],
      "dependencies": {
        "blocks": ["task-2-1-2"],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "details": "Add example based on our experience: 88 errors → fix → 4 errors → fix → still 4 errors → requires manual intervention. Show complete terminal output and interpretation.",
        "location": "In troubleshooting or examples section"
      }
    },

    "task-2-1-2": {
      "type": "subtask",
      "title": "Add code snippets with expected output",
      "status": "pending",
      "parent": "task-2-1",
      "children": [],
      "dependencies": {
        "blocks": ["task-2-1-3"],
        "blocked_by": ["task-2-1-1"],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "details": "Show actual sdd validate/fix command output with exit codes, error counts, and auto-fix status. Include before/after examples showing successful partial fixes.",
        "location": "Throughout relevant sections"
      }
    },

    "task-2-1-3": {
      "type": "subtask",
      "title": "Add AI assistant guidelines",
      "status": "pending",
      "parent": "task-2-1",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": ["task-2-1-2"],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "details": "Add callout box or section explaining: (1) Don't interpret exit 2 as failure, (2) Always re-validate after fix, (3) Check error count progression, (4) When to report issues vs continue fixing",
        "location": "Near exit code explanation section"
      }
    },

    "phase-2-verify": {
      "type": "group",
      "title": "Verification",
      "status": "pending",
      "parent": "phase-2",
      "children": ["verify-2-1"],
      "dependencies": {
        "blocks": [],
        "blocked_by": ["phase-2-files"],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {}
    },

    "verify-2-1": {
      "type": "verify",
      "title": "Examples are accurate and match tool behavior",
      "status": "pending",
      "parent": "phase-2-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "manual",
        "command": "# Manual verification required",
        "expected": "Run the example commands from documentation and verify: (1) exit codes match, (2) output format matches, (3) workflow produces described results, (4) AI assistant guidelines prevent our original confusion"
      }
    }
  }
}
