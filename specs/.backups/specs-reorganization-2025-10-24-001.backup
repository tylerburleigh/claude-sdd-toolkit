{
  "spec_id": "specs-reorganization-2025-10-24-001",
  "title": "Specs Directory Reorganization",
  "generated": "2025-10-24T17:35:00Z",
  "last_updated": "2025-10-25T13:35:33.455854+00:00",
  "metadata": {
    "status": "draft",
    "complexity": "low",
    "estimated_hours": 4,
    "description": "Separate generated metadata files (validation reports, review outputs, backups) from actual spec JSON files by creating dedicated hidden directories and updating all CLI code to use new paths."
  },
  "hierarchy": {
    "spec-root": {
      "type": "spec",
      "title": "Specs Directory Reorganization",
      "status": "in_progress",
      "parent": null,
      "children": [
        "phase-1",
        "phase-2",
        "phase-3",
        "phase-4",
        "phase-5"
      ],
      "total_tasks": 22,
      "completed_tasks": 3,
      "metadata": {
        "objectives": [
          "Clean up specs/active/, specs/completed/, specs/archived/ directories",
          "Centralize metadata in hidden directories (.reports/, .reviews/, .backups/)",
          "Update CLI code to use new paths automatically",
          "Maintain backward compatibility where reasonable",
          "Add to .gitignore to keep directories local"
        ]
      }
    },
    "phase-1": {
      "type": "phase",
      "title": "Directory Structure & Gitignore",
      "status": "in_progress",
      "parent": "spec-root",
      "children": [
        "phase-1-files",
        "phase-1-verify"
      ],
      "dependencies": {
        "blocks": [
          "phase-2",
          "phase-3",
          "phase-4"
        ],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 5,
      "completed_tasks": 3,
      "metadata": {
        "purpose": "Create new directory structure and update version control settings",
        "risk_level": "low",
        "estimated_hours": 0.5
      }
    },
    "phase-1-files": {
      "type": "group",
      "title": "File Modifications",
      "status": "completed",
      "parent": "phase-1",
      "children": [
        "task-1-1",
        "task-1-2",
        "task-1-3"
      ],
      "dependencies": {
        "blocks": [
          "phase-1-verify"
        ],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 3,
      "completed_tasks": 3,
      "metadata": {}
    },
    "task-1-1": {
      "type": "task",
      "title": "Create specs/.reports/ directory",
      "status": "completed",
      "parent": "phase-1-files",
      "children": [],
      "dependencies": {
        "blocks": [
          "task-2-1",
          "task-5-1"
        ],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 1,
      "metadata": {
        "file_path": "specs/.reports/",
        "description": "Create hidden directory for validation reports with README",
        "changes": "mkdir -p specs/.reports && add README.md explaining purpose",
        "parallel_safe": false,
        "completed_at": "2025-10-25T12:56:33.262857+00:00",
        "needs_journaling": true,
        "status_note": "Created specs/.reports/ directory with comprehensive README.md documentation. Directory is ready to receive validation reports from sdd-validate tool."
      }
    },
    "task-1-2": {
      "type": "task",
      "title": "Create specs/.reviews/ directory",
      "status": "completed",
      "parent": "phase-1-files",
      "children": [],
      "dependencies": {
        "blocks": [
          "task-4-1",
          "task-5-2"
        ],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 1,
      "metadata": {
        "file_path": "specs/.reviews/",
        "description": "Create hidden directory for review outputs with README",
        "changes": "mkdir -p specs/.reviews && add README.md explaining purpose",
        "parallel_safe": false,
        "started_at": "2025-10-25T13:12:18.927080+00:00",
        "completed_at": "2025-10-25T13:15:34.760926+00:00",
        "needs_journaling": true,
        "status_note": "Implemented automated .reviews/ directory generation. Created template file, utility functions in common/paths.py, integrated with sdd-plan-review CLI. Reviews now automatically save to .reviews/ directory."
      }
    },
    "task-1-3": {
      "type": "task",
      "title": "Create specs/.backups/ directory",
      "status": "completed",
      "parent": "phase-1-files",
      "children": [],
      "dependencies": {
        "blocks": [
          "task-3-1",
          "task-5-3"
        ],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 1,
      "metadata": {
        "file_path": "specs/.backups/",
        "description": "Create hidden directory for backup files with README",
        "changes": "mkdir -p specs/.backups && add README.md explaining purpose",
        "parallel_safe": false,
        "completed_at": "2025-10-25T13:35:33.455682+00:00",
        "needs_journaling": true,
        "status_note": "Implemented as automated feature following .reports/.reviews pattern"
      }
    },
    "phase-1-verify": {
      "type": "group",
      "title": "Verification",
      "status": "pending",
      "parent": "phase-1",
      "children": [
        "verify-1-1",
        "verify-1-2"
      ],
      "dependencies": {
        "blocks": [],
        "blocked_by": [
          "phase-1-files"
        ],
        "depends": []
      },
      "total_tasks": 2,
      "completed_tasks": 0,
      "metadata": {}
    },
    "verify-1-1": {
      "type": "verify",
      "title": "Directories exist and are accessible",
      "status": "pending",
      "parent": "phase-1-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "auto",
        "command": "ls -la specs/.reports specs/.reviews specs/.backups",
        "expected": "All three directories exist with README files"
      }
    },
    "verify-1-2": {
      "type": "verify",
      "title": "Gitignore prevents tracking",
      "status": "pending",
      "parent": "phase-1-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "auto",
        "command": "git status specs/.reports specs/.reviews specs/.backups",
        "expected": "Directories not shown in git status (ignored)"
      }
    },
    "phase-2": {
      "type": "phase",
      "title": "Update Validation Report Paths",
      "status": "pending",
      "parent": "spec-root",
      "children": [
        "phase-2-files",
        "phase-2-verify"
      ],
      "dependencies": {
        "blocks": [
          "phase-5"
        ],
        "blocked_by": [
          "phase-1"
        ],
        "depends": []
      },
      "total_tasks": 3,
      "completed_tasks": 0,
      "metadata": {
        "purpose": "Modify sdd-validate to save reports to specs/.reports/",
        "risk_level": "low",
        "estimated_hours": 1
      }
    },
    "phase-2-files": {
      "type": "group",
      "title": "File Modifications",
      "status": "pending",
      "parent": "phase-2",
      "children": [
        "task-2-1"
      ],
      "dependencies": {
        "blocks": [
          "phase-2-verify"
        ],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 2,
      "completed_tasks": 0,
      "metadata": {}
    },
    "task-2-1": {
      "type": "task",
      "title": "src/claude_skills/claude_skills/sdd_validate/cli.py",
      "status": "pending",
      "parent": "phase-2-files",
      "children": [
        "task-2-1-1",
        "task-2-1-2"
      ],
      "dependencies": {
        "blocks": [
          "task-5-1"
        ],
        "blocked_by": [
          "task-1-1"
        ],
        "depends": []
      },
      "total_tasks": 2,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "src/claude_skills/claude_skills/sdd_validate/cli.py",
        "estimated_hours": 0.5
      }
    },
    "task-2-1-1": {
      "type": "subtask",
      "title": "Update cmd_validate report path (line 219)",
      "status": "pending",
      "parent": "task-2-1",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "description": "Change report_file path from spec_file.parent to specs/.reports/",
        "line_number": 219,
        "changes": "report_file = Path('specs/.reports') / f\"{spec_file.stem}-validation-report{suffix}\""
      }
    },
    "task-2-1-2": {
      "type": "subtask",
      "title": "Update cmd_report default output path (lines 400-404)",
      "status": "pending",
      "parent": "task-2-1",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "description": "Change default output_path from spec_file.parent to specs/.reports/",
        "line_number": 400,
        "changes": "output_path = Path(args.output) if args.output else Path('specs/.reports') / spec_file.stem"
      }
    },
    "phase-2-verify": {
      "type": "group",
      "title": "Verification",
      "status": "pending",
      "parent": "phase-2",
      "children": [
        "verify-2-1"
      ],
      "dependencies": {
        "blocks": [],
        "blocked_by": [
          "phase-2-files"
        ],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {}
    },
    "verify-2-1": {
      "type": "verify",
      "title": "Validation reports save to .reports/",
      "status": "pending",
      "parent": "phase-2-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "auto",
        "command": "sdd validate specs/active/test-spec.json --report && ls specs/.reports/",
        "expected": "Report file appears in specs/.reports/ directory"
      }
    },
    "phase-3": {
      "type": "phase",
      "title": "Update Backup File Paths",
      "status": "pending",
      "parent": "spec-root",
      "children": [
        "phase-3-files",
        "phase-3-verify"
      ],
      "dependencies": {
        "blocks": [
          "phase-5"
        ],
        "blocked_by": [
          "phase-1"
        ],
        "depends": []
      },
      "total_tasks": 2,
      "completed_tasks": 0,
      "metadata": {
        "purpose": "Modify sdd-validate to save backups to specs/.backups/",
        "risk_level": "low",
        "estimated_hours": 0.5
      }
    },
    "phase-3-files": {
      "type": "group",
      "title": "File Modifications",
      "status": "pending",
      "parent": "phase-3",
      "children": [
        "task-3-1"
      ],
      "dependencies": {
        "blocks": [
          "phase-3-verify"
        ],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {}
    },
    "task-3-1": {
      "type": "task",
      "title": "src/claude_skills/claude_skills/sdd_validate/fix.py",
      "status": "pending",
      "parent": "phase-3-files",
      "children": [
        "task-3-1-1"
      ],
      "dependencies": {
        "blocks": [
          "task-5-3"
        ],
        "blocked_by": [
          "task-1-3"
        ],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "src/claude_skills/claude_skills/sdd_validate/fix.py",
        "estimated_hours": 0.5
      }
    },
    "task-3-1-1": {
      "type": "subtask",
      "title": "Update backup path generation (line 131)",
      "status": "pending",
      "parent": "task-3-1",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "description": "Change backup_path to save in specs/.backups/ instead of same directory",
        "line_number": 131,
        "changes": "backup_path = Path('specs/.backups') / f\"{Path(spec_path).stem}.json.backup\""
      }
    },
    "phase-3-verify": {
      "type": "group",
      "title": "Verification",
      "status": "pending",
      "parent": "phase-3",
      "children": [
        "verify-3-1"
      ],
      "dependencies": {
        "blocks": [],
        "blocked_by": [
          "phase-3-files"
        ],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {}
    },
    "verify-3-1": {
      "type": "verify",
      "title": "Backup files save to .backups/",
      "status": "pending",
      "parent": "phase-3-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "auto",
        "command": "sdd fix specs/active/test-spec.json && ls specs/.backups/",
        "expected": "Backup file appears in specs/.backups/ directory"
      }
    },
    "phase-4": {
      "type": "phase",
      "title": "Update Review Output Paths",
      "status": "pending",
      "parent": "spec-root",
      "children": [
        "phase-4-files",
        "phase-4-verify"
      ],
      "dependencies": {
        "blocks": [
          "phase-5"
        ],
        "blocked_by": [
          "phase-1"
        ],
        "depends": []
      },
      "total_tasks": 2,
      "completed_tasks": 0,
      "metadata": {
        "purpose": "Modify sdd-plan-review to save reviews to specs/.reviews/",
        "risk_level": "low",
        "estimated_hours": 0.5
      }
    },
    "phase-4-files": {
      "type": "group",
      "title": "File Modifications",
      "status": "pending",
      "parent": "phase-4",
      "children": [
        "task-4-1"
      ],
      "dependencies": {
        "blocks": [
          "phase-4-verify"
        ],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {}
    },
    "task-4-1": {
      "type": "task",
      "title": "src/claude_skills/claude_skills/sdd_plan_review/cli.py",
      "status": "pending",
      "parent": "phase-4-files",
      "children": [
        "task-4-1-1"
      ],
      "dependencies": {
        "blocks": [
          "task-5-2"
        ],
        "blocked_by": [
          "task-1-2"
        ],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "src/claude_skills/claude_skills/sdd_plan_review/cli.py",
        "estimated_hours": 0.5
      }
    },
    "task-4-1-1": {
      "type": "subtask",
      "title": "Update default output path (lines 132-154)",
      "status": "pending",
      "parent": "task-4-1",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "description": "When no --output specified, save to specs/.reviews/ instead of current directory",
        "line_number": 132,
        "changes": "Add logic to default output_path to specs/.reviews/{spec_id}-review{.json|.md}"
      }
    },
    "phase-4-verify": {
      "type": "group",
      "title": "Verification",
      "status": "pending",
      "parent": "phase-4",
      "children": [
        "verify-4-1"
      ],
      "dependencies": {
        "blocks": [],
        "blocked_by": [
          "phase-4-files"
        ],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {}
    },
    "verify-4-1": {
      "type": "verify",
      "title": "Review outputs save to .reviews/",
      "status": "pending",
      "parent": "phase-4-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "manual",
        "command": "Run review on test spec and verify output location",
        "expected": "Review files appear in specs/.reviews/ directory"
      }
    },
    "phase-5": {
      "type": "phase",
      "title": "Migration & Testing",
      "status": "pending",
      "parent": "spec-root",
      "children": [
        "phase-5-files",
        "phase-5-verify"
      ],
      "dependencies": {
        "blocks": [],
        "blocked_by": [
          "phase-2",
          "phase-3",
          "phase-4"
        ],
        "depends": []
      },
      "total_tasks": 10,
      "completed_tasks": 0,
      "metadata": {
        "purpose": "Move existing metadata files and verify all functionality works",
        "risk_level": "medium",
        "estimated_hours": 1.5
      }
    },
    "phase-5-files": {
      "type": "group",
      "title": "File Modifications",
      "status": "pending",
      "parent": "phase-5",
      "children": [
        "task-5-1",
        "task-5-2",
        "task-5-3"
      ],
      "dependencies": {
        "blocks": [
          "phase-5-verify"
        ],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 3,
      "completed_tasks": 0,
      "metadata": {}
    },
    "task-5-1": {
      "type": "task",
      "title": "Move validation reports to .reports/",
      "status": "pending",
      "parent": "phase-5-files",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [
          "task-1-1",
          "task-2-1"
        ],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "specs/active/*-validation-report*.md",
        "description": "Move existing *-validation-report.md files from specs/active/ to specs/.reports/",
        "changes": "mv specs/active/*-validation-report*.md specs/.reports/",
        "parallel_safe": true
      }
    },
    "task-5-2": {
      "type": "task",
      "title": "Move review files to .reviews/",
      "status": "pending",
      "parent": "phase-5-files",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [
          "task-1-2",
          "task-4-1"
        ],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "specs/active/*-review.*",
        "description": "Move existing *-review.json and *-review.md files from specs/active/ to specs/.reviews/",
        "changes": "mv specs/active/*-review.* specs/.reviews/",
        "parallel_safe": true
      }
    },
    "task-5-3": {
      "type": "task",
      "title": "Move backup files to .backups/",
      "status": "pending",
      "parent": "phase-5-files",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [
          "task-1-3",
          "task-3-1"
        ],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "specs/active/*.json.backup",
        "description": "Move existing *.json.backup files from specs/active/ to specs/.backups/",
        "changes": "mv specs/active/*.json.backup specs/.backups/",
        "parallel_safe": true
      }
    },
    "phase-5-verify": {
      "type": "group",
      "title": "Verification",
      "status": "pending",
      "parent": "phase-5",
      "children": [
        "verify-5-1",
        "verify-5-2",
        "verify-5-3",
        "verify-5-4",
        "verify-5-5",
        "verify-5-6",
        "verify-5-7"
      ],
      "dependencies": {
        "blocks": [],
        "blocked_by": [
          "phase-5-files"
        ],
        "depends": []
      },
      "total_tasks": 7,
      "completed_tasks": 0,
      "metadata": {}
    },
    "verify-5-1": {
      "type": "verify",
      "title": "specs/active/ is clean",
      "status": "pending",
      "parent": "phase-5-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "auto",
        "command": "ls specs/active/ | grep -E '(validation-report|review|backup)'",
        "expected": "No metadata files found in specs/active/"
      }
    },
    "verify-5-2": {
      "type": "verify",
      "title": "Validation report generation works",
      "status": "pending",
      "parent": "phase-5-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "auto",
        "command": "sdd validate specs/active/specs-reorganization-2025-10-24-001.json --report",
        "expected": "Report created in specs/.reports/"
      }
    },
    "verify-5-3": {
      "type": "verify",
      "title": "Backup file creation works",
      "status": "pending",
      "parent": "phase-5-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "auto",
        "command": "sdd fix specs/active/specs-reorganization-2025-10-24-001.json --preview && check backup location",
        "expected": "Backup created in specs/.backups/ if fixes applied"
      }
    },
    "verify-5-4": {
      "type": "verify",
      "title": "Custom --output flag still works",
      "status": "pending",
      "parent": "phase-5-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "manual",
        "command": "sdd report specs/active/test.json --output /tmp/test-report.md",
        "expected": "Report created at specified custom path, not default .reports/"
      }
    },
    "verify-5-5": {
      "type": "verify",
      "title": "All migrated files accessible",
      "status": "pending",
      "parent": "phase-5-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "auto",
        "command": "ls -R specs/.reports/ specs/.reviews/ specs/.backups/",
        "expected": "All previously moved files present in new locations"
      }
    },
    "verify-5-6": {
      "type": "verify",
      "title": "Gitignore working correctly",
      "status": "pending",
      "parent": "phase-5-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "auto",
        "command": "git status | grep -E '(.reports|.reviews|.backups)'",
        "expected": "No metadata directories appear in git status"
      }
    },
    "verify-5-7": {
      "type": "verify",
      "title": "End-to-end workflow test",
      "status": "pending",
      "parent": "phase-5-verify",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "manual",
        "command": "Create spec -> validate with report -> fix with backup -> verify locations",
        "expected": "All outputs in correct hidden directories, specs/active/ remains clean"
      }
    }
  },
  "journal": [
    {
      "timestamp": "2025-10-25T13:06:41.517869+00:00",
      "entry_type": "note",
      "title": "Task 1-1: Automated Implementation",
      "author": "claude-code",
      "content": "Updated implementation from manual one-time creation to automated generation. The .reports/ directory and README are now automatically created by the SDD toolkit when needed. Changes: Added ensure_reports_directory() function in common/paths.py, created template file at common/templates/reports_readme.md, integrated into sdd-validate, sdd-next, and sdd-plan CLIs for defensive creation at multiple entry points. Updated pyproject.toml to package template files.",
      "metadata": {}
    },
    {
      "timestamp": "2025-10-25T13:15:44.026856+00:00",
      "entry_type": "note",
      "title": "Task 1-2: Automated .reviews/ Directory",
      "author": "claude-code",
      "content": "Implemented automated generation of specs/.reviews/ directory following the same pattern as .reports/. Created template file at common/templates/reviews_readme.md with comprehensive documentation. Added generate_reviews_readme_content() and ensure_reviews_directory() functions to common/paths.py. Exported functions in common/__init__.py. Integrated with sdd_plan_review/cli.py to automatically save review outputs to .reviews/ directory (defaults to .reviews/, can override with --output). Template is already included in pyproject.toml package data pattern. Tested successfully - directory and README auto-generate on first use.",
      "metadata": {}
    }
  ]
}