# claude-sdd-toolkit - AI Assistant Context

**Version:** 1.0.0
**Generated:** 2025-10-24 10:59:57

---

## About This Document

This is a quick reference guide for AI coding assistants working with this codebase.
It provides essential context, key concepts, and common patterns to help AI assistants
provide better suggestions and understand the codebase structure.

---

### 1. Project Overview

This project is a command-line toolkit designed as a plugin for the Claude Code environment. It provides a suite of tools to support a professional "spec-driven development" (SDD) workflow. The toolkit helps developers and AI assistants collaborate on coding tasks by enforcing a structured, plan-first development process. Users, primarily software developers working within the Claude Code ecosystem, leverage these tools to generate development plans, implement code changes based on those plans, and validate the results against a formal specification.

### 2. Domain Concepts

-   **SDD (Spec-Driven Development)**: The core methodology supported by the toolkit. It's a development process that starts with a formal, machine-readable "spec" outlining the required changes.
    -   *Usage*: The entire toolkit is built around this concept. Commands like `sdd-plan`, `sdd-update`, and `sdd-validate` are the main drivers of the SDD workflow.

-   **Spec (Specification)**: A JSON file (typically `sdd_spec.json`) that formally describes the project's structure, dependencies, and the intended changes. It serves as the single source of truth for the development task.
    -   *Usage*: Parsed and manipulated by `src/claude_skills/claude_skills/common/spec.py`. Its structure is defined in `schemas/sdd-spec-schema.json`.

-   **Plan**: A detailed, step-by-step guide for implementing the changes described in the spec. It's often generated by an AI based on the spec.
    -   *Usage*: The `sdd-plan` command and its core logic in `src/claude_skills/claude_skills/sdd_plan/planner.py` are responsible for creating this.

-   **Journal**: A log of operations performed during the `sdd-update` process. It tracks file creations, modifications, and deletions, providing a transparent audit trail of changes.
    -   *Usage*: Managed by `src/claude_skills/claude_skills/sdd_update/journal.py`.

-   **Validation**: The process of checking the implemented code against the spec to ensure all requirements have been met and no new issues have been introduced.
    -   *Usage*: The `sdd-validate` command, with logic in `src/claude_skills/claude_skills/sdd_validate/`, performs this check.

-   **Skill**: A self-contained command or tool within the toolkit (e.g., `code-doc`, `sdd-plan`). Each skill has its own module and CLI entry point.
    -   *Usage*: The project is structured into directories for each skill under `src/claude_skills/claude_skills/`. They are registered in `src/claude_skills/claude_skills/cli/sdd/registry.py`.

### 3. Critical Files Analysis

1.  **`schemas/sdd-spec-schema.json`**: Defines the JSON schema for the `sdd_spec.json` file. This is the foundational file that dictates the structure of all spec-driven work. All other tools are consumers of the spec defined here.

2.  **`src/claude_skills/claude_skills/common/spec.py`**: A crucial utility module for reading, parsing, and interacting with the `sdd_spec.json` file. It provides a Pythonic interface to the spec, abstracting away the raw JSON. It's a dependency for almost every SDD-related skill.

3.  **`src/claude_skills/claude_skills/sdd_plan/cli.py` & `planner.py`**: The entry point and core logic for the `sdd-plan` command. This is the starting point of the main SDD workflow, responsible for taking a spec and generating a detailed implementation plan.

4.  **`src/claude_skills/claude_skills/sdd_update/cli.py` & `workflow.py`**: The entry point and core logic for the `sdd-update` command. This is where the plan is executed, and file system operations (create, update, delete) happen. It's the most critical file in terms of making changes to the user's codebase.

5.  **`src/claude_skills/claude_skills/sdd_validate/cli.py` & `fix.py`**: The entry point and core logic for the `sdd-validate` command. This file is critical for ensuring the quality and correctness of the changes by comparing the final code state against the original spec.

6.  **`src/claude_skills/claude_skills/cli/sdd/registry.py`**: The central registry where all `sdd` subcommands (skills) are imported and made available to the main CLI. It's the integration point for all skills.

### 4. Common Workflow Patterns

**1. The Core SDD Workflow:**
This is the primary pattern for making changes to a codebase.
-   **Step 1: Plan (`sdd-plan`)**: A user or AI generates/updates an `sdd_spec.json` file. Then, they run `claude sdd-plan` to generate a detailed implementation plan (`PLAN.md`).
-   **Step 2: Review (`sdd-plan-review`)**: The generated plan is reviewed for correctness and feasibility.
-   **Step 3: Update (`sdd-update`)**: The developer or AI executes the plan using `claude sdd-update`, which modifies the project files.
-   **Step 4: Validate (`sdd-validate`)**: After the update, `claude sdd-validate` is run to check if the changes conform to the spec. It can also attempt to auto-fix certain issues.
-   **Step 5: Next (`sdd-next`)**: Once validation passes, `claude sdd-next` is used to archive the current spec and prepare the workspace for the next task.

**2. Documenting Code (`code-doc`):**
A utility workflow for generating documentation for existing code.
-   **Step 1**: Run `claude code-doc <path_to_source_file>`.
-   **Step 2**: The tool analyzes the file, extracts entities (classes, functions), and generates documentation in a specified format (e.g., Markdown).

**3. Running Tests (`run-tests`):**
A workflow for discovering and running project tests.
-   **Step 1**: The user runs `claude run-tests`.
-   **Step 2**: The tool discovers tests using configured patterns (e.g., pytest), executes them, and reports the results.

### 5. Potential Gotchas

1.  **Strict Spec Schema**: The `sdd_spec.json` is the heart of the workflow, but its schema is complex and strict. An invalid or poorly formed spec will cause all downstream tools (`plan`, `update`, `validate`) to fail. AI assistants must be careful to generate specs that conform perfectly to `schemas/sdd-spec-schema.json`.

2.  **Stateful Workflow**: The SDD commands are highly stateful and intended to be run in a specific order (`plan` -> `update` -> `validate`). Running them out of order (e.g., `sdd-validate` before `sdd-update`) will lead to errors or nonsensical results. The presence and content of `sdd_spec.json` and the `journal.json` are critical state artifacts.

3.  **File System Operations**: The `sdd-update` command performs destructive file system operations. A flawed plan or a bug in the update logic could lead to incorrect code modifications or data loss. AI assistants should double-check plans before suggesting execution.

4.  **Configuration Complexity**: Some skills, like `run-tests` and `doc-query`, rely on `config.yaml` files. The configuration options might not be immediately obvious, and misconfiguration can lead to the tools not working as expected (e.g., failing to discover any tests).

### 6. Extension Patterns

The toolkit is designed to be extended by adding new "skills". The general pattern is as follows:

1.  **Create a New Skill Directory**: Add a new directory under `src/claude_skills/claude_skills/` (e.g., `my_new_skill`).

2.  **Create a CLI Entry Point**: Inside the new directory, create a `cli.py` file. This file should use the `click` library to define the command, its options, and its arguments. The structure should mimic existing `cli.py` files (e.g., `src/claude_skills/claude_skills/sdd_plan/cli.py`).

3.  **Implement Core Logic**: Add other Python files to the directory to implement the skill's core logic, separating it from the CLI interface.

4.  **Register the Skill**: Open `src/claude_skills/claude_skills/cli/sdd/registry.py` and import the `click` command object from your new `cli.py`. Add this command object to the `COMMANDS` list. This makes the new skill available as a subcommand (e.g., `claude sdd my-new-skill`).

5.  **Follow Conventions**: New code should follow the existing project structure, using the `common` utilities for tasks like spec parsing, printing, and validation where applicable. Add tests for the new skill in the `src/claude_skills/tests/` directory.


---

*This context was generated with assistance from AI analysis.*